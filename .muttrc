# -*-mode: conf-*-
# for mutt-1.5.13
# Time-stamp: <2009-06-03 10:30:30 stm>

source ~/.mutt/ui

# save copy of mail in sent-mail
set record = =INBOX
set sort=threads
set sort_aux=reverse-date-received

set assumed_charset = 'utf-8:iso-8859-1:iso-8859-15:us-ascii'
set charset = 'utf-8'
set send_charset = 'utf-8:us-ascii:iso-8859-1'

set attribution = 'Den %d skrev %n:'
set beep = no
set forward_quote = yes
set include = yes

set menu_scroll = yes
#set metoo = yes
set realname = 'Steen Manniche'
#set reply_self = yes

set mail_check=90         # check for new mail every 90 seconds

set index_format="%4C %Z %{%b %d} %-15.15L %?M?(#%03M)&(%4l)? %?y?(%.20Y) ?%s"

set status_format = '[ %n(%u/%o)/%m - %p postponed ] [%P - sort: %s - lim it: %V] '


# viewing html
macro pager \cb <pipe-entry>'python $HOME/local/bin/urlview.py'<enter> 'Use urlview.py to view urls'
# see .mailcap:
alternative_order  text/enriched text/plain text/html
auto_view text/html

# text/html; elinks -dump -force-html %s; needsterminal; copiousoutput;

# using abook as adressbook
set query_command = "abook --mutt-query '%s'"
macro generic,index,pager \ca "<shell-escape>abook<return>" "launch abook"

macro index,pager A "<pipe-message>abook --add-email<return>" "add the sender address to abook"

# To get straight to the folder browser when copying and moving mail,
# add the following macros:
 
macro index C "<copy-message>?<toggle-mailboxes>" "copy a message to a mailbox"
macro index M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"
macro pager M "<save-message>?<toggle-mailboxes>" "move a message to a mailbox"

macro index , "<save-message>?" "move message to mailbox"

# Attachments handling
macro attach W "<tag-prefix><save-entry><kill-line>/home/stm/downloads/mutt"
macro attach E "<save-entry><kill-line>/home/stm/<enter>"

#macros for filtering views
# Keys are Shift-S <key>
macro index Sn "<limit>~N|~O<enter>" "view only new, unread mails"
macro index Sa '<limit>~A<enter>'
macro index Su '<limit>~C steen manniche<enter>'

# sendmail
set sendmail="/usr/bin/esmtp -v -X /tmp/esmtp.log"
set use_envelope_from=yes

set editor="muttedit.sh"

###########
# hooks

# save-hooks
save-hook .* =/INBOX

# search using namazu2 with nmzmail
# remember to do an nmzmail -i <maildir1> <maildir2> ... after each offlineimap run
macro generic S "<shell-escape>nmzmail<return><esc>c~/.nmzmail/result<return>" "Search via nmzmail"

#########
# labels

# macro index y "<enter-command>set editor=\"~/local/bin/editlabel append\"\n\
# <edit><sync-mailbox><next-undeleted>\
# <enter-command>set editor=emacs\n" "Append label"
# macro pager y "<enter-command>set editor=\"~/local/bin/editlabel append\"\n\
# <edit><sync-mailbox><next-undeleted>\
# <enter-command>set editor=emacs\n" "Append label"
# macro index Y "<enter-command>set editor=\"~/local/bin/editlabel menu\"\n\
# <edit><sync-mailbox><next-undeleted>\
# <enter-command>set editor=emacs\n" "Edit labels"
# macro pager Y "<enter-command>set editor=\"~/local/bin/editlabel menu\"\n\
# <edit><sync-mailbox><next-undeleted>\
# <enter-command>set editor=emacs\n" "Edit labels"
# macro index \Cy "<limit>~y " "Limit view to label"
